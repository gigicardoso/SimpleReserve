<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-12 col-md-8 col-lg-6">
      <div class="card shadow">
        <div class="card-header bg-success text-white d-flex align-items-center justify-content-between">
          <h2 class="mb-0 flex-grow-1"><i class="fas fa-door-open me-2"></i>{{#if tipoSala}}Editar Tipo de Sala{{else}}Cadastrar Tipo de Sala{{/if}}</h2>
        </div>
        <div class="card-body">
          <form id="tipoSalaForm" action="{{#if tipoSala}}/editarTipoSala/{{tipoSala.id_tipo_sala}}{{else}}/tipoSala{{/if}}" method="POST">
            <div class="mb-3">
              <label for="descricao" class="form-label">Tipo de Sala</label>
              <input
                type="text"
                id="descricao"
                name="descricao"
                class="form-control"
                required
                placeholder="Ex: Auditório, Laboratório, Sala de Reunião, etc."
                value="{{#if tipoSala}}{{tipoSala.descricao}}{{/if}}"
              />
            </div>
            <button type="submit" class="btn btn-success w-100">
              <i class="fas fa-save me-2"></i>{{#if tipoSala}}Salvar Alterações{{else}}Cadastrar Tipo de Sala{{/if}}
            </button>
          </form>
          {{#if erro}}
            <div class="alert alert-danger mt-3" role="alert">
              {{erro}}
            </div>
          {{/if}}
        </div>
      </div>
    </div>
  </div>
</div>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link rel="stylesheet" href="/stylesheets/bloco.css">
<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.querySelector('form');
  if (!form) return;
  form.addEventListener('submit', async function(e) {
    e.preventDefault();
    const nomeTipoSala = document.getElementById('descricao').value.trim();
    try {
      const resp = await fetch(`/api/tipoSala/check?nome=${encodeURIComponent(nomeTipoSala)}`);
      const result = await resp.json();
      if (result && result.duplicado) {
        const msg = `${nomeTipoSala} já foi cadastrado, tem certeza que quer prosseguir?`;
        if (!window.confirm(msg)) return;
      }
    } catch (err) {
      // Se erro, deixa enviar
    }
    form.submit();
  });
});
</script>