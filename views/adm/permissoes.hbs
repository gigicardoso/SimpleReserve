<div class="container">
	<div class="header" style="margin-bottom: 10px;">
		<div class="title-container" style="display: flex; align-items: center; gap: 20px;">
			<h1 style="margin-bottom: 10px;"><i class="bi bi-award"></i> Gerenciador de Permissões</h1>
			<a href="/permissoes/adicionapermissao" class="btn-add" id="btnAddPermissao" title="Adicionar permissão" style="text-decoration: none; display: flex; align-items: center; justify-content: center;">
				<i class="bi bi-plus" style="font-size: 2rem; vertical-align: middle;"></i>
			</a>
		</div>
		<div class="alert alert-info" role="alert" style="margin-top:15px; padding:15px; border-left: 4px solid #0dcaf0; background-color: #cff4fc;">
			<h6 style="margin:0 0 10px 0; font-weight:600;"><i class="bi bi-info-circle"></i> Como funcionam as permissões:</h6>
			<ul style="margin:0; padding-left:20px; font-size:0.9rem;">
				<li><strong>Administrador = Sim:</strong> acesso total a Blocos, Andares, Tipos de Mesa/Sala, Permissões, Usuários e Salas (ignora as outras colunas)</li>
				<li><strong>Administrador = Não:</strong> acesso apenas aos módulos com permissões específicas marcadas:
					<ul>
						<li><strong>Usuários:</strong> precisa de "Cadastrar/Editar/Arquivar Usuário"</li>
						<li><strong>Salas:</strong> precisa de "Cadastrar/Editar/Arquivar Sala"</li>
						<li><strong>Reservas:</strong> visível para todos com acesso ao Gerenciador ADM</li>
					</ul>
				</li>
			</ul>
		</div>
	</div>
	<div class="user-table-container" style="margin-top: 18px;">
		<table class="user-table">
			<thead>
				<tr>
					<th>Nome</th>
					<th>Administrador</th>
					<th>Cadastrar Sala</th>
					<th>Editar Salas</th>
					<th>Arquivar Sala</th>
					<th>Cadastrar Usuário</th>
					<th>Editar Usuário</th>
					<th>Arquivar Usuário</th>
					<th>Ações</th>
				</tr>
			</thead>
			<tbody>
				{{#if permissoes.length}}
					{{#each permissoes}}
						<tr>
							<td>{{this.descricao}}</td>
							<td>{{#if this.adm}}Sim{{else}}Não{{/if}}</td>
							<td>{{#if this.cadSala}}Sim{{else}}Não{{/if}}</td>
							<td>{{#if this.edSalas}}Sim{{else}}Não{{/if}}</td>
							<td>{{#if this.arqSala}}Sim{{else}}Não{{/if}}</td>
							<td>{{#if this.cadUser}}Sim{{else}}Não{{/if}}</td>
							<td>{{#if this.edUser}}Sim{{else}}Não{{/if}}</td>
							<td>{{#if this.arqUser}}Sim{{else}}Não{{/if}}</td>
							<td class="actions">
								<a href="/permissoes/editarPermissao/{{id_permissao}}" class="btn-action btn-edit">
									<i class="bi bi-pencil"></i>
									<span>Editar</span>
								</a>
								<a href="/permissoes/excluirPermissao/{{id_permissao}}" class="btn-action btn-delete">
									<i class="bi bi-trash"></i>
									<span>Excluir</span>
								</a>
							</td>
						</tr>
					{{/each}}
				{{else}}
					<tr class="empty-message-row">
						<td colspan="9" class="empty-message">
							Nenhuma permissão cadastrada. Clique no botão <i class="bi bi-plus" style="font-size: 1.2rem;"></i> para adicionar.
						</td>
					</tr>
				{{/if}}
			</tbody>
		</table>
	</div>
</div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<link rel="stylesheet" href="/stylesheets/usuariosAdm.css">
<script>
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.btn-delete').forEach(function(btn) {
    btn.addEventListener('click', function(e) {
      if (!window.confirm('Tem certeza que deseja excluir esta permissão?')) {
        e.preventDefault();
      }
    });
  });
});
</script>
